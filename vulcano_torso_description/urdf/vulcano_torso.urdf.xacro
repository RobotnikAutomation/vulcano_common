<?xml version="1.0"?>
<robot name="vulcano_torso" xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:property name="PI" value="3.1415926535897931"/>
  <xacro:property name="deg2rad" value="0.01745329251"/>
  <xacro:property name="elevation_max_longitude" value="0.7"/>
  <xacro:property name="z_elevation_joint" value="0.442"/>

  <!-- Define the torso -->
  <xacro:macro name="vulcano_torso" params="prefix *origin">
    <link name="${prefix}base_link">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0 "/>
        <mass value="1000"/>
        <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
      </inertial>
    </link>
    <joint name="${prefix}guidance_base_joint" type="fixed">
      <!--<origin xyz="0.47 0 0.474" rpy="0 0 0"/>-->
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <parent link="${prefix}base_link"/>
      <child link="${prefix}guidance_base_link"/>
      <axis xyz="0 0 1"/>
    </joint>
    <link name="${prefix}guidance_base_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_base.stl"/>
        </geometry>
       <material name="darkgrey">
         <color rgba="0.1 0.1 0.1 1"/>
       </material>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_base.stl"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="1000"/>
        <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
      </inertial>
    </link>
    <joint name="${prefix}revolution_joint" type="revolute">
      <!-- TODO: especificar zona muerta, limites de articulacion y parametros de simulacion -->
      <!--origin xyz="0 0 0" rpy="0 0 ${60*deg2rad}" /-->
      <origin xyz="0 0 0" rpy="0 0 3.1415"/>
      <parent link="${prefix}guidance_base_link"/>
      <child link="${prefix}guidance_main_link"/>
      <axis xyz="0 0 1"/>
      <limit lower="${-172*deg2rad}" upper="${172*deg2rad}" effort="100" velocity="100"/>
      <dynamics friction="1000" damping="1000"/>
    </joint>
    <link name="${prefix}guidance_main_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_main.stl"/>
        </geometry>
       <material name="darkgrey">
         <color rgba="0.1 0.1 0.1 1"/>
       </material>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_main.stl"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="1000"/>
        <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
      </inertial>
    </link>
    <joint name="${prefix}elevation_joint" type="prismatic">
      <!-- TODO: especificar limites de articulacion y parametros de simulacion -->
      <origin xyz="0 0 0.115" rpy="0 0 0"/>
      <parent link="${prefix}guidance_main_link"/>
      <child link="${prefix}guidance_slide_link"/>
      <axis xyz="0 0 1"/>
      <limit lower="0" upper="0.739" effort="100" velocity="100"/>
    </joint>
    <link name="${prefix}guidance_slide_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_slide.stl"/>
        </geometry>
       <material name="darkgrey">
         <color rgba="0.1 0.1 0.1 1"/>
       </material>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/guidance_slide.stl"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="1"/>
        <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
      </inertial>
    </link>
    <joint name="${prefix}tkd668_joint" type="fixed">
      <origin xyz="0.164 0 0.449" rpy="0 0 0"/>
      <parent link="${prefix}guidance_slide_link"/>
      <child link="${prefix}tkd668_link"/>
      <axis xyz="0 0 1"/>
    </joint>
    <link name="${prefix}tkd668_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/tkd668.stl"/>
        </geometry>
       <material name="darkgrey">
         <color rgba="0.1 0.1 0.1 1"/>
       </material>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://vulcano_torso_description/meshes/tkd668.stl"/>
        </geometry>
      </collision>
    </link>
  </xacro:macro>
</robot>
